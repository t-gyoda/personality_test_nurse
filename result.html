<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>è¨ºæ–­çµæœ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="./config.js"></script>
</head>

<body class="bg-[#f5f3ef] text-slate-800">
  <div class="max-w-4xl mx-auto p-6">
    <div class="hidden bg-amber-400/80 bg-slate-400/80 bg-emerald-400/80 bg-rose-400/80"></div>

    <div class="flex flex-wrap items-center justify-between gap-2 mb-4">
      <h1 class="text-2xl font-bold text-slate-800">è¨ºæ–­çµæœ</h1>
      <a class="text-sm text-slate-500 underline" href="./index.html">ãƒˆãƒƒãƒ—ã¸</a>
    </div>

    <!-- çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
    <div id="resultBox" class="bg-white/75 rounded-3xl p-6 md:p-8 border border-rose-200/60 shadow-sm">
      <div id="msg" class="text-gray-600">èª­ã¿è¾¼ã¿ä¸­â€¦</div>
    </div>

    <!-- ãƒ¡ãƒ¼ãƒ«é€ä¿¡ -->
    <div id="mailBox" class="bg-white/75 rounded-3xl border border-rose-200/60 p-5 md:p-6 mt-6 hidden shadow-sm">
      <div class="font-semibold mb-2 text-slate-800">çµæœã‚’ãƒ¡ãƒ¼ãƒ«ã§å—ã‘å–ã‚‹ï¼ˆä»»æ„ï¼‰</div>
      <input id="email" type="email"
        class="w-full border border-rose-200/70 rounded-2xl p-3 bg-white focus:outline-none focus:ring-2 focus:ring-rose-200"
        placeholder="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹" />
      <label class="flex items-center gap-2 mt-3 text-sm text-slate-600">
        <input id="consent" type="checkbox" class="h-4 w-4">
        <span>ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã«åŒæ„ã—ã¾ã™</span>
      </label>
      <div class="flex items-center gap-2 mt-3">
        <button id="sendBtn"
          class="px-5 py-2 rounded-2xl bg-[#eaa5bb] text-white font-semibold transition hover:bg-[#e38fac]">
          é€ä¿¡
        </button>
        <div id="sendMsg" class="text-sm text-slate-500"></div>
      </div>
    </div>

    <!-- ä¸‹éƒ¨ãƒœã‚¿ãƒ³ -->
    <div class="mt-6 flex flex-wrap gap-2">
      <a id="backLink" class="px-4 py-2 rounded-2xl border border-rose-200/70 bg-white/80" href="./index.html">æˆ»ã‚‹</a>
      <a class="px-4 py-2 rounded-2xl bg-[#eaa5bb] text-white font-semibold hover:bg-[#e38fac]" href="./types.html">
        16ã‚¿ã‚¤ãƒ—ä¸€è¦§ã¸
      </a>
      <a class="px-4 py-2 rounded-2xl bg-[#eaa5bb] text-white font-semibold hover:bg-[#e38fac]" href="./compat.html">
        ç›¸æ€§è¨ºæ–­ã¸
      </a>
    </div>
  </div>

<script>
  function GAS_URL(){
    const u = window.APP_CONFIG && window.APP_CONFIG.GAS_URL;
    if(!u) throw new Error('APP_CONFIG.GAS_URL ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
    return u;
  }

  const escapeHtml = s =>
    String(s ?? '').replace(/[&<>"']/g, m =>
      ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])
    );

  const cleanText = s => escapeHtml((s || '').trim());

  function loadResultFromSession(){
    const raw = sessionStorage.getItem('LAST_RESULT_JSON');
    if(!raw) return null;
    try { return JSON.parse(raw); } catch { return null; }
  }

  function main(){
    const box = document.getElementById('resultBox');
    const out = loadResultFromSession();
    if(!out){
      box.textContent = 'çµæœãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚';
      return;
    }

    const r = out.report || {};

    box.innerHTML = `
      <!-- â˜… è¨ºæ–­åã®ä¸Šã«ä½™ç™½ã‚’ã—ã£ã‹ã‚Šç¢ºä¿ -->
      <section class="text-center mt-12">
        <div class="text-4xl md:text-6xl font-extrabold tracking-tight">
          ${cleanText(r.typeName || out.typeName || out.typeCode)}
        </div>

        <div class="mt-3 text-base md:text-lg text-slate-600 font-semibold">
          ${cleanText(out.typeCode)}
        </div>

        <div class="mt-7 flex justify-center">
          <div class="w-full max-w-xs aspect-square rounded-[26px] bg-white/80 border border-rose-200/60 flex items-center justify-center">
            <div class="text-6xl">ğŸ©º</div>
          </div>
        </div>

        <!-- â˜… ç‰¹å¾´ï¼šå¤ªå­—å¯„ã‚Šï¼‹ä½™ç™½ -->
        <div class="mt-7 mx-auto max-w-2xl text-lg md:text-xl font-medium text-slate-700 leading-relaxed whitespace-pre-wrap">
          ${cleanText(r.feature)}
        </div>
      </section>

      <!-- â˜… ç‰¹å¾´ã¨æ€§æ ¼ç‰¹æ€§ã®é–“ã«ä½™ç™½ã‚’è¿½åŠ  -->
      <section class="mt-14">
        <div class="font-semibold text-lg flex items-center gap-2">
          <span>ğŸ“Š</span>æ€§æ ¼ç‰¹æ€§
        </div>
        <div class="mt-4 grid gap-3 md:grid-cols-2">
          ${renderTraits(out.traits)}
        </div>
      </section>

      <!-- â˜… æœ¬æ–‡æ–‡å­—ã‚µã‚¤ã‚ºã‚’ä¸€æ®µéšã‚¢ãƒƒãƒ— -->
      <section class="mt-12 grid gap-6">
        <div class="rounded-2xl bg-white/80 border border-rose-200/60 p-5">
          <div class="font-semibold text-lg flex items-center gap-2">âœ¨ å¼·ã¿</div>
          <div class="mt-3 text-lg md:text-xl whitespace-pre-wrap leading-relaxed">
            ${cleanText(r.strengths)}
          </div>
        </div>

        <div class="rounded-2xl bg-white/80 border border-rose-200/60 p-5">
          <div class="font-semibold text-lg flex items-center gap-2">ğŸŒ¿ æ³¨æ„ç‚¹</div>
          <div class="mt-3 text-lg md:text-xl whitespace-pre-wrap leading-relaxed">
            ${cleanText(r.cautions)}
          </div>
        </div>

        <div class="rounded-2xl bg-white/80 border border-rose-200/60 p-5">
          <div class="font-semibold text-lg flex items-center gap-2">ğŸ’¡ ãƒ¯ãƒ³ãƒã‚¤ãƒ³ãƒˆã‚¢ãƒ‰ãƒã‚¤ã‚¹</div>
          <div class="mt-3 text-lg md:text-xl whitespace-pre-wrap leading-relaxed">
            ${cleanText(r.advice)}
          </div>
        </div>
      </section>
    `;
  }

  main();
</script>
</body>
</html>
